import { themes, Invert } from 'mdx-deck'
import { Box } from 'theme-ui'
import { CodeSurfer, CodeSurferColumns, Step } from 'code-surfer'
import { github, vsDark } from '@code-surfer/themes'

export const theme = {
  ...themes.prism,
  ...themes.future
}

# React Properties and State

---

<CodeSurferColumns themes={[vsDark, github, vsDark]}>

<Step>

<Box p={100}>

## Properties

In React properties, or props, are our way to pass data to a
component. Props are passed to a component as an object. These
props are read-only, which means that we cannot (or should not)
change their values.

</Box>

```js showNumbers title="Functional Component Properties" subtitle="function props"
import React from 'react';

const MyComponent = props => (
  <h1>{props.title}</h1>
);
```

```js showNumbers title="Class Component Properties" subtitle="class props"
import React, { Component } from 'react';

class MyComponent extends Component {
  render() {
    return (
      <h1>{this.props.title}</h1>
    )
  }
}
```

</Step>

<Step>

<Box p={100}>

## Properties

In React properties, or props, are our way to pass data to a
component. Props are passed to a component as an object. These
props are read-only, which means that we cannot (or should not)
change their values.

</Box>

```diff 3[21:25],4[8:12] subtitle="props is a plain JavaScript Object (POJO)"
```

```diff 6[12:21] subtitle="props is a plain JavaScript Object (POJO)"
```

</Step>

<Step>

<Box p={100}>

## Properties

In React properties, or props, are our way to pass data to a
component. Props are passed to a component as an object. These
props are read-only, which means that we cannot (or should not)
change their values.

</Box>

```diff 3[21:25] subtitle="functional components get passed props as their first parameter"
```

```diff 6[12:15] subtitle="class components have access to props via a class property"
```

</Step>

<Step>

<Box p={100}>

## Properties

In React properties, or props, are our way to pass data to a
component. Props are passed to a component as an object. These
props are read-only, which means that we cannot (or should not)
change their values.

</Box>

```js title="Functional Component Properties" subtitle="Destructure props"
import React from 'react';

const MyComponent = ({ title }) => (
  <h1>{title}</h1>
);
```

```js title="Class Component Properties" subtitle="class props destructured"
import React, { Component } from 'react';

class MyComponent extends Component {
  render() {
    const { title } = this.props;
    return (
      <h1>{title}</h1>
    )
  }
}
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns themes={[github, github, vsDark]}>

<Step>

<Box p={100}>

## Type Checking Props

In order to keep readability high, even in complex applications
and components, its often nice to add prop type checking. This
makes it easier for developers to know what types they can
pass as props as well as providing nice error messaging should
a developer pass in the wrong type.

</Box>

```js showNumbers title="Functional Component Properties"
import React from 'react';

const MyComponent = ({ title }) => (
  <h1>{title}</h1>
);
```

```js showNumbers title="Class Component Properties"
import React, { Component } from 'react';

class MyComponent extends Component {
  render() {
    const { title } = this.props;
    return (
      <h1>{title}</h1>
    )
  }
}
```

</Step>

<Step>

<Box p={100}>

## Type Checking Props

In order to keep readability high, even in complex applications
and components, its often nice to add prop type checking. This
makes it easier for developers to know what types they can
pass as props as well as providing nice error messaging should
a developer pass in the wrong type.

</Box>

```js showNumbers title="Functional Component Properties"
import React from 'react';
import PropTypes from 'prop-types'

const MyComponent = ({ title }) => (
  <h1>{title}</h1>
);

MyComponent.propTypes = {
  title: PropTypes.string.isRequired
};
```

```js showNumbers title="Class Component Properties"
import React, { Component } from 'react';
import PropTypes from 'prop-types';

class MyComponent extends Component {
  static propTypes = {
    title: PropTypes.string.isRequired
  }

  render() {
    const { title } = this.props;
    return (
      <h1>{title}</h1>
    )
  }
}
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns themes={[github, vsDark]}>

<Step>

<Box p={100}>

## Passing Props

Both Functional Components and Class Components behave the same and are passed props with the same syntax.

</Box>

```js
<MyComponent title="Hello" />
```

</Step>

</CodeSurferColumns>

---

import MyComponent from '../components/MyComponent.js'

<CodeSurferColumns themes={[github, vsDark]}>

<Step>

<Box p={100}>

## State

In React state is data that can change (e.g. form inputs). This
state is stored in an object instantiated inside of a class component.
This state can only be transformed by the class component who
instantiated it. This component is considered the owner of state.

</Box>

```js showNumbers 9:12
import React, { Component } from 'react';
import PropTypes from 'prop-types';

class MyComponent extends Component {
  static propTypes = {
    title: PropTypes.string.isRequired
  }

  state = {
    text: '',
    counter: 0
  }

  handleChange = ({ target }) => {
    this.setState({ text: target.value });
  }

  increment = () => {
    this.setState(state => ({ counter: state.counter + 1 }));
  }

  render() {
    const { title } = this.props;
    const { text, counter } = this.state;

    return (
      <>
        <h1>{title} - {text} - {counter}</h1>
        <input type="text" value={text} onChange={this.handleChange} />
        <button onClick={this.increment}>Increment</button>
      </>
    )
  }
}
```

</Step>

<Step>

<Box p={100}>

### How state changes (change categories)

* state change is independent of previous state (independent)
  * forms
  * time

</Box>

```diff 14:16 subtitle="Independent State Change"
```

</Step>

<Step>

<Box p={100}>

### How state changes (change categories)

* state change is independent of previous state (independent)
  * forms
  * time
* state change is dependent on previous state (dependent)
  * toggles

</Box>

```diff 18:20 subtitle="Dependent State Change"
```

</Step>

<Step>

<MyComponent title="Hello All" />

```diff
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns themes={[github, github, vsDark]}>

<Step>

```js showNumbers title="State Provider"
import React, { Component } from 'react';
import PropTypes from 'prop-types';
import MyView from './MyView';

export default class MyComponent extends Component {
  static propTypes = {
    title: PropTypes.string.isRequired
  }

  state = {
    text: '',
    counter: 0
  }

  handleChange = ({ target }) => {
    this.setState({ text: target.value });
  }

  increment = () => {
    this.setState(state => ({ counter: state.counter + 1 }));
  }

  render() {
    const { title } = this.props;
    const { text, counter } = this.state;

    return (
        <MyView
          title={title}
          text={text}
          couter={counter}
          handleChange={this.handleChange}
          increment={this.increment} />
    )
  }
}
```

<Box p={100}>

### Passing state to other components

The owner of a piece of state can pass that state to other
components via props. As props the data transferred becomes
read-only.

</Box>

```js showNumbers title="State Consumer"
import React from 'react';
import PropTypes from 'prop-types';

const MyView = ({ title, text, counter, handleChange, increment }) => (
  <>
    <h1>{title} - {text} - {counter}</h1>
    <input type="text" value={text} onChange={handleChange} />
    <button onClick={increment}>Increment</button>
  </>
);

MyView.propTypes = {
  title: PropTypes.string.isRequired,
  text: PropTypes.string.isRequired,
  counter: PropTypes.number.isRequired,
  handleChange: PropTypes.func.isRequired,
  increment: PropTypes.func.isRequired
};

export default MyView;
```

</Step>

<Step>

```diff 29:31
```

<Box p={100}>

### Passing state to other components

The owner of a piece of state can pass that state to other
components via props. As props the data transferred becomes
read-only.

</Box>

```diff 4[19:23,26:29,32:38]
```

</Step>

<Step>

```diff 32:33
```

<Box p={100}>

### Updating state from other components

State is passed from owner (provider) to other components
(consumer) as props. Only the provider is authorized to change
state. If a consumer wants to change state it has to ask the
provider to change state. This is done by passing functions
from provider to consumer. The functions are invoked in the consumer,
but run in the provider. These function are often called events.

</Box>

```diff 4[41:52,55:63],7[47:58],8[22:30]
```

</Step>

<Step>

```diff
```
<Box p={100}>

### Data Flow

In React data flows from parent to child, and event flow
from child to parent. Data down, events up.

</Box>

```diff
```

</Step>

</CodeSurferColumns>
